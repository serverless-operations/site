{"hash":"7f941d81843b6b274431cd2b599fad9eb656e895","data":{"wordPressBlog":{"title":"Serverless FrameworkでStep Functionsが使えるプラグインをリリースしました","content":"\n<h2 class=\"wp-block-heading\">概要</h2>\n\n\n\n<p><a href=\"https://github.com/horike37/serverless-step-functions\" rel=\"noreferrer noopener\" target=\"_blank\">Serverless Step Functions</a>&nbsp;をリリースしました。Serverlessのコマンドを通してStep Functionsのデプロイや実行が可能です。Step Functionsを定義するためのAmazon State Languageもyamlで書くことが可能です。</p>\n\n\n\n<h2 class=\"wp-block-heading\">Step Functionの定義</h2>\n\n\n\n<p>以下のようにstepFunctionsというステートメントを作って、そこにAmazon State Languageでstep functionを記述してください。yamlの記述のみ対応してます。<br>Resourceには通常、LambdaファンクションのARNを指定しますが、functionsステートメントの中のfunction名を指定すれば、OKです</p>\n\n\n\n<pre class=\"wp-block-code language-yaml\"><code>functions:\n  hellofunc:\n    handler: handler.hello\n\nstepFunctions:\n  stateMachines:\n    hellostepfunc:\n      Comment: \"A Hello World example of the Amazon States Language using an AWS Lambda Function\"\n      StartAt: HelloWorld\n      States: \n        HelloWorld: \n          Type: Task\n          Resource: hellofunc\n          End: true\n﻿</code></pre>\n\n\n\n<h2 class=\"wp-block-heading\">コマンドの使い方</h2>\n\n\n\n<p><code>deploy</code>,&nbsp;<code>invoke</code>,&nbsp;<code>remove</code>というコマンドを用意しています。<br>すべて、&#8211;state か -t でstep function名を指定します。上記の例で言えば、<code>hellostepfunc</code>を指定します。これは必須のオプションです。</p>\n\n\n\n<p>また、&#8211;stageと&#8211;regionのオプションにも対応しているので、テスト環境と本番環境を分けたりといったことも可能です。</p>\n\n\n\n<h3 class=\"wp-block-heading\">デプロイ</h3>\n\n\n\n<p>以下がコマンドになります</p>\n\n\n\n<pre class=\"wp-block-code language-ssh\"><code>$ sls deploy stepf statemachines --name &lt;stepfunctionname> </code></pre>\n\n\n\n<p>ちなみに、Step Functionは更新に対応していないのですが、作成済みのStep Functionを削除して新規作成することで更新に対応してます。実行履歴とかは消えちゃいますが、そこは仕方ないっすね。。</p>\n\n\n\n<h3 class=\"wp-block-heading\">Step Function実行</h3>\n\n\n\n<p>&#8211;data か -d で引数のJSONデータを指定します</p>\n\n\n\n<pre class=\"wp-block-code language-ssh\"><code>$ sls invoke stepf --state &lt;stepfunctionname> --data '{\"foo\":\"bar\"}'</code></pre>\n\n\n\n<h3 class=\"wp-block-heading\">削除</h3>\n\n\n\n<pre class=\"wp-block-code language-ssh\"><code>$ sls delete stepf --state &lt;stepfunctionname></code></pre>\n\n\n\n<h2 class=\"wp-block-heading\">まとめ</h2>\n\n\n\n<p>是非、フィードバックなどお待ちしています！それでは良いステップファンクションライフを！</p>\n","author":{"name":"Takahiro Horike","description":"Co-founder and CEO of Serverless Operations, Inc","avatars":{"avatar96":"https://secure.gravatar.com/avatar/2ee9db3a5b6c492acf66ec14c8a5d8dc?s=96&d=mm&r=g"},"acf":{"userJpName":"堀家 隆宏","userRole":"CEO","facebook":"https://www.facebook.com/horike.takahiro","twitter":"https://twitter.com/horike37","github":"https://github.com/horike37"}},"date":"2017.04.17","path":"/blog/52/","featuredMedia":{"sourceUrl":"https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/07/https___camo.githubusercontent.jpeg","altText":"","mediaDetails":{"width":1950}},"categories":[{"id":"7","title":"Blog","path":"/category/blog/"}],"tags":[{"id":"11","title":"Serverless Framework","path":"/tag/serverless-framework/"},{"id":"18","title":"Step Functions","path":"/tag/step-functions/"}]},"metadata":{"siteName":"Serverless Operations","siteDescription":"Serverless Operationsは、これまでグローバルの第一線で培ってきたクラウド技術（AWS − アマゾンウェブサービス）の豊富な実績と知見を活かし、お客さまのサーバーレスによる開発や運用の支援、コンサルティングまで一貫してサポート。サーバーレスに関するさまざまな課題を解決いたします。","siteUrl":"https://serverless.co.jp","siteOgImage":"https://serverless.co.jp/ogp.png"}},"context":{}}