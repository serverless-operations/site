<!DOCTYPE html>
<html data-html-server-rendered="true" lang="ja" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22ja%22%7D%7D">
  <head>
    <title>AWSマーケットプレイスへSaaSプロダクトを掲載するために必要な作業まとめ | Serverless Operations</title><meta name="gridsome:hash" content="35053359aff549c8e1d81009f00eae950570ae45"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="og:locale" property="og:locale" content="ja_JP"><meta data-vue-tag="ssr" data-key="og:site_name" property="og:site_name" content="Serverless Operations"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:image" content="https://serverless.co.jp/ogp.png"><meta data-vue-tag="ssr" data-key="og:type" property="og:type" content="article"><meta data-vue-tag="ssr" data-key="og:url" property="og:url" content="https://serverless.co.jp/blog/284/"><meta data-vue-tag="ssr" data-key="og:image" property="og:image" content="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/05/so-release.png"><meta data-vue-tag="ssr" data-key="og:title" property="og:title" content="AWSマーケットプレイスへSaaSプロダクトを掲載するために必要な作業まとめ | Serverless Operations"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:image" content="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/05/so-release.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css"><link data-vue-tag="ssr" data-key="canonical" rel="canonical" href="https://serverless.co.jp/blog/284/"><link rel="preload" href="/assets/css/0.styles.d9bfd87e.css" as="style"><link rel="preload" href="/assets/js/app.5df06ac4.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--word-press-blog-vue.0a0eef1f.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.f0ef102d.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.832deef9.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-archives-vue.7efdfc40.js"><link rel="prefetch" href="/assets/js/page--src--pages--contact-vue.a038f445.js"><link rel="prefetch" href="/assets/js/page--src--pages--download-vue.64eb66c2.js"><link rel="prefetch" href="/assets/js/page--src--pages--event-archives-vue.4f2af68d.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.0bf1ff2b.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-archives-vue.77200956.js"><link rel="prefetch" href="/assets/js/page--src--pages--our-products-vue.fde3a04c.js"><link rel="prefetch" href="/assets/js/page--src--pages--privacy-policy-vue.6ff4c5d2.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--aws-serverless-vue.eeeffcda.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--aws-serverless-vue~page--src--pages--services--iot-serverless-vue.bada637e.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--index-vue.661d8bc2.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--iot-serverless-vue.71225155.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--serverless-consulting-vue.d04bf66c.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--serverless-development-vue.bc80dcc7.js"><link rel="prefetch" href="/assets/js/page--src--pages--test-form-vue.890dafea.js"><link rel="prefetch" href="/assets/js/page--src--pages--works-archives-vue.86aa6e78.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-category-vue.33b1d2eb.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-post-tag-vue.c9658cdc.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-post-vue.7e9cc383.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-works-vue.0135712a.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--contact-vue~page--src--pages--download-vue.7a23cb3f.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--our-products-vue.8e9052c2.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--word-press-blog-vue.16b09ab1.js"><link rel="stylesheet" href="/assets/css/0.styles.d9bfd87e.css"><script data-vue-tag="ssr">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MLP4448');</script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div id="app" data-server-rendered="true" class="v-application v-application--is-ltr theme--dark" data-v-7de3dd27><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MLP4448" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="v-application--wrap"><header class="header-nav" data-v-5f4f5539><div class="header-nav__logo-block" data-v-5f4f5539><a href="/" class="header-nav__logo-link active" data-v-5f4f5539><img src="/assets/img/header-logo.a93f880b.svg" alt="Severless Operations ロゴ" class="header-nav__logo" data-v-5f4f5539></a></div><nav data-v-5f4f5539><ul data-v-5f4f5539><li data-v-5f4f5539><a href="/about" data-v-5f4f5539>私たちについて</a></li><li data-v-5f4f5539><a href="/services" data-v-5f4f5539>サービス</a></li><li data-v-5f4f5539><a href="/works-archives" data-v-5f4f5539>実績紹介</a></li><li data-v-5f4f5539><a href="/blog-archives" data-v-5f4f5539>ブログ</a></li><li data-v-5f4f5539><a href="/news-archives" data-v-5f4f5539>お知らせ</a></li><li data-v-5f4f5539><a href="/download" data-v-5f4f5539>会社資料ダウンロード</a></li><li data-v-5f4f5539><a href="/contact" data-v-5f4f5539>お問い合わせ</a></li></ul></nav><div id="app" class="header-nav__toggler-block d-block d-md-none" data-v-5f4f5539><button id="btn" type="button" class="header-nav__toggler-button btn" data-v-5f4f5539><div tabindex="-1" class="btn__content" data-v-5f4f5539><span class="header-nav__toggler-top" data-v-5f4f5539></span><span class="header-nav__toggler-middle" data-v-5f4f5539></span><span class="header-nav__toggler-bottom" data-v-5f4f5539></span></div></button></div><!----></header><main class="v-content"><div class="v-content" data-v-7de3dd27><div class="v-content__wrap" data-v-7de3dd27><div class="container" data-v-7de3dd27><p class="category-title" data-v-7de3dd27>
          Blog
        </p></div><header class="post-header" data-v-7de3dd27><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><div class="col-md-10 col-11" data-v-7de3dd27><h1 class="post-title" data-v-7de3dd27>AWSマーケットプレイスへSaaSプロダクトを掲載するために必要な作業まとめ</h1><div class="post-tag-container" data-v-7de3dd27><time datetime="2020.12.07" class="post-date" data-v-7de3dd27> 
                  2020.12.07
                  
                </time><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>AWS</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>marketplace</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>SaaS</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>Serverless</span></div></div></div></div></div></header><article class="post-container" data-v-7de3dd27><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><div class="post-article-container col-md-10 col-11" data-v-7de3dd27><div class="post-article" data-v-7de3dd27>
<p>弊社では、サーバーレスにフォーカスしたコストマネジメントSaaS、<a rel="noreferrer noopener" href="http://costless.io/ja" data-type="URL" data-id="http://costless.io/ja" target="_blank">Costless</a>をAWSマーケットプレイスに掲載しました。本記事はそのために行ってきた作業の内容について整理します。</p>



<h2 class="wp-block-heading">料金モデルの選定</h2>



<p><a rel="noreferrer noopener" href="https://aws.amazon.com/marketplace/management/tour" data-type="URL" data-id="https://aws.amazon.com/marketplace/management/tour" target="_blank">AWSマーケットプレイスポータル</a>（AMMP）で販売者登録と口座登録の手続きを済ませると、SaaSプロダクトの価格体系に合わせて以下のいずれかの料金モデルを選択し製品登録を行います。SaaS側はそれに合わせてマーケットプレイスとSaaSプロダクトとのインテグレーションを実装する形になります。</p>



<figure class="wp-block-table is-style-stripes"><table><tbody><tr><td>料金モデル</td><td>説明</td></tr><tr><td>SaaSサブスクリプション</td><td>いわゆる従量課金制モデルで、SaaSプロダクトを時間単位での利用に基づいて課金するといった場合に適しています。</td></tr><tr><td>SaaS契約</td><td>事前に決まった金額を支払いして一定期間SaaS製品を利用する形態の料金モデルです。</td></tr><tr><td>SaaS契約（従量課金あり）</td><td>SaaS 契約に加え、更に従量課金のオプションを混合することができるモデルです。最も多くのタイプの料金プランを実現できます。SaaS サブスクリプションとSaaS契約の両方をカバーできるので将来的にはおすすめの料金モデルですが、その分他に比べて実装の手間も増えることになります。</td></tr></tbody></table></figure>



<h2 class="wp-block-heading">顧客登録及びSaaSプロダクトとの紐付け</h2>



<p>顧客がマーケットプレイスの製品ページを開いて登録（Subscribe）ボタンを押した時にリダイレクトされる、SaaS側のランディングページを用意します。顧客名、連絡先、会社名など適宜必要な顧客情報を入力してもらい、SaaS側に連携します。</p>



<p>ここで、ランディングページが開く際、マーケットプレイス側よりカスタマーID、プロダクトコードといった情報と引き換えるためのトークンを付加してリダイレクトしてくれます。SaaS側はこのトークンを受け取り、マーケットプレイスのResolveCustomerというAPIを呼び出してカスタマーIDを取得、SaaS側のユーザー情報及び各機能などが制御できるように統合します。</p>



<p>「SaaS契約」の場合、更にEntitlementという契約情報を登録、管理する必要があります。DynamoDBを利用すると良いでしょう。</p>



<h2 class="wp-block-heading">各種サブスクリプション状態の管理</h2>



<p>顧客がマーケットプレイスでサブスクリプションの登録／解除や契約変更を行った場合、予めマーケットプレイス側から用意される専用SNSトピックにその状態が通知されます。</p>



<p>具体的にはSaaS契約の場合 <code>entitlement-updated</code> , SaaSサブスクリプションの場合４パターン（ <code>subscribe-success</code>, <code>subscribe-fail</code>, <code>unsubscribe-pending</code>, <code>unsubscribe-success</code> ）の状態が通知されます。SaaS側ではこれらの状態変更の通知を受け適宜対応する形になります。</p>



<h2 class="wp-block-heading">従量課金処理の対応</h2>



<p>SaaSサブスクリプションとSaaS契約の従量課金を実装したい場合、１時間ごとにユーザーの使用量に対する課金単位（ユニット）をマーケットプレイス側に送信する必要があります。製品登録時に構成した料金区分に合わせて課金単位の量を計算し、BatchMeterUsageという API を利用して送信します。</p>



<h2 class="wp-block-heading">AWSマーケットプレイスチームによるE2Eテスト</h2>



<p>ここまで来たら、マーケットプレイスと統合するための作業は一通り完了します。最後に、AWSマーケットプレイスチームへ進捗を連絡すると、製品レビューとE2Eテストが実施されます。公式ドキュメントの「<a rel="noreferrer noopener" href="https://docs.aws.amazon.com/ja_jp/marketplace/latest/userguide/aws-marketplace-integration-checklist.html" data-type="URL" data-id="https://docs.aws.amazon.com/ja_jp/marketplace/latest/userguide/aws-marketplace-integration-checklist.html" target="_blank">SaaS製品チェックリスト</a>」を参考に、抜け漏れがないかチェックしましょう。無事テストが通れば、公開日を設定してリリースとなります。</p>



<h2 class="wp-block-heading">まとめ</h2>



<p>マーケットプレイス統合において、必要となる作業を簡単にまとめると以下のようになります。</p>



<ul id="block-ca23dd63-f024-436b-a1af-735b6dcfef8a"><li>料金モデルの選定</li><li>顧客登録及びSaaSプロダクトとの紐付け</li><li>各種サブスクリプション状態の管理</li><li>従量課金処理の対応</li><li>AWSマーケットプレイスチームによるE2Eテスト</li></ul>



<p>統合を行う際に必要となるAWSリソースと構成について、AWSマーケットプレイスチームが公開している<a rel="noreferrer noopener" href="https://github.com/aws-samples/aws-marketplace-serverless-saas-integration" data-type="URL" data-id="https://github.com/aws-samples/aws-marketplace-serverless-saas-integration" target="_blank">サンプル</a>がありますので、ご参考ください。フルサーバーレス構成で構築可能です。紫の丸がSaaS契約、オレンジの丸がSaaSサブスクリプションで必要となるリソースとなります。</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="675" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/12/Serverless-MP-1024x675.png" alt="" class="wp-image-285" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/12/Serverless-MP-1024x675.png 1024w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/12/Serverless-MP-300x198.png 300w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/12/Serverless-MP-768x506.png 768w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/12/Serverless-MP.png 1327w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>※ &#8220;<a class="" href="https://github.com/aws-samples/aws-marketplace-serverless-saas-integration">aws-marketplace-serverless-saas-integration</a>&#8221; より抜粋</figcaption></figure>



<p>Serverless Operationsでは、今回の構築経験を基にマーケットプレイスへの掲載に必要な統合の設計・開発の支援を行っています。お気軽に<a rel="noreferrer noopener" href="https://serverless.co.jp/contact" data-type="URL" data-id="https://serverless.co.jp/contact" target="_blank">お問い合わせ</a>ください。</p>
</div><section class="l-share-button" data-v-629ec8b5 data-v-7de3dd27><aside class="p-share-button" data-v-629ec8b5><div class="p-share-button__header" data-v-629ec8b5>SHARE</div><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fserverless.co.jp%2Fblog%2F284%2F" target="_blank" title="Facebookでシェア" class="p-share-button__link--facebook " data-v-629ec8b5><i class="mdi mdi-facebook" data-v-629ec8b5></i></a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fserverless.co.jp%2Fblog%2F284%2F&amp;text=AWS%E3%83%9E%E3%83%BC%E3%82%B1%E3%83%83%E3%83%88%E3%83%97%E3%83%AC%E3%82%A4%E3%82%B9%E3%81%B8SaaS%E3%83%97%E3%83%AD%E3%83%80%E3%82%AF%E3%83%88%E3%82%92%E6%8E%B2%E8%BC%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E4%BD%9C%E6%A5%AD%E3%81%BE%E3%81%A8%E3%82%81" target="_blank" title="Twitterでシェア" class="p-share-button__link--twitter" data-v-629ec8b5><i class="mdi mdi-twitter" data-v-629ec8b5></i></a></aside></section><div class="post-author-container" data-v-7de3dd27><h5 class="post-author-title" data-v-7de3dd27>Written by</h5><div class="post-author-text" data-v-7de3dd27><p data-v-7de3dd27><span class="role" data-v-7de3dd27>
                      COO
                    </span><span class="name-jp" data-v-7de3dd27>
                      金 仙優
                    </span><span class="name-en" data-v-7de3dd27>
                      Sonu Kim
                    </span></p><p class="author-desc" data-v-7de3dd27>
                    
                  </p><ul class="author-sns" data-v-7de3dd27><li data-v-7de3dd27><!----></li><li data-v-7de3dd27><!----></li><li data-v-7de3dd27><!----></li></ul></div></div></div></div></div><div class="p-news-bg" data-v-7de3dd27></div></article><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><a href="/blog-archives" class="post-archives-link" data-v-7de3dd27><span class="post-archives-link-text" data-v-7de3dd27>BACK TO LIST</span><span data-v-7de3dd27><img src="/assets/img/icon-back-to-list.3add3700.svg" alt="BACK TO LIST アイコン" data-v-7de3dd27></span></a></div></div></div></div></main><footer class="v-footer footer v-sheet v-sheet--tile theme--dark" data-v-a49f4c2c><div class="container" data-v-a49f4c2c data-v-a49f4c2c><div class="row" data-v-a49f4c2c data-v-a49f4c2c><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/works-archives" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Works</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>実績紹介</div></a><ul class="c-footer-list" data-v-a49f4c2c><div data-v-b68eaa08 data-v-a49f4c2c><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/501/" class="c-footer-list__link" data-v-b68eaa08>
      戸田建設株式会社
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/396/" class="c-footer-list__link" data-v-b68eaa08>
      北海道テレビ放送株式会社
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/358/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社Geolonia
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/24/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社LIXIL
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/185/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社TOKION
    </a></li></div></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><div data-v-a49f4c2c><a href="/services" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Services</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>サービス紹介</div></a></div><ul class="c-footer-list" data-v-a49f4c2c><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスオペレーションズの<br data-v-a49f4c2c>サービスと強み</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/iot-serverless" class="c-footer-list__link" data-v-a49f4c2c>
              IoT × サーバーレス / コンテナ開発<br data-v-a49f4c2c>導⼊サポート
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/aws-serverless" class="c-footer-list__link" data-v-a49f4c2c>
              AWSコアサーバーレスサービスの開発導⼊サポート
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/serverless-consulting" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスコンサルティング</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/serverless-development" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスディべロプメント</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/our-products" class="c-footer-list__link" data-v-a49f4c2c>
              自社開発プロダクト
            </a></li></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/blog-archives" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Blog</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>開発ブログ</div></a><ul class="c-footer-list" data-v-a49f4c2c><div data-v-39434060 data-v-a49f4c2c><li class="c-footer-list__item" data-v-39434060><a href="/blog/640/" class="c-footer-list__link" data-v-39434060>
      AWS 開発基盤として、セキュリティを考慮したマルチアカウント構成のススメ
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/532/" class="c-footer-list__link" data-v-39434060>
      AWS Amplify GraphQL Transformer v2 のデータモデリングとリレーションの仕組みを解説する
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/512/" class="c-footer-list__link" data-v-39434060>
      AWS Lambda + Nuxt3で実現する「サーバーレスなSSR」とその構成
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/25/" class="c-footer-list__link" data-v-39434060>
      Serverless Frameworkの使い方まとめ
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/450/" class="c-footer-list__link" data-v-39434060>
      軽量で簡単に使えるキャッシュSaaS、MomentoをAWS Lambdaから使ってみる
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/429/" class="c-footer-list__link" data-v-39434060>
      Next.js アプリケーションを AWS Amplify でホスティングする上でのTIPS
    </a></li></div></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/about" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>About</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>会社案内</div></a><ul class="c-footer-list" data-v-a49f4c2c><li class="c-footer-list__item" data-v-a49f4c2c><a href="/about" class="c-footer-list__link" data-v-a49f4c2c>
              会社案内
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/news-archives/" class="c-footer-list__link" data-v-a49f4c2c>
              おしらせ
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/privacy-policy/" class="c-footer-list__link" data-v-a49f4c2c>
              プライバシーポリシー
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/download" class="c-footer-list__link" data-v-a49f4c2c>
              会社資料ダウンロード
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/contact" class="c-footer-list__link" data-v-a49f4c2c>
              お問い合わせ
            </a></li></ul></div></div><div class="row mt-8 mt-md-12" data-v-a49f4c2c data-v-a49f4c2c><div class="col-md-2 col-12" data-v-a49f4c2c data-v-a49f4c2c><div data-v-a49f4c2c><a href="/" class="active" data-v-a49f4c2c><img src="/assets/img/footer-severless-operations-logo.e1e6687a.svg" alt="Severless Operations ロゴ" data-v-a49f4c2c></a></div></div><div class="col-md-10 col-12" data-v-a49f4c2c data-v-a49f4c2c><div class="sns-link text-md-right" data-v-a49f4c2c><a href="https://github.com/serverless-operations" target="_blank" class="sns-link__github" data-v-a49f4c2c><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--light" data-v-a49f4c2c></i></a><a href="https://twitter.com/slsopsinc" target="_blank" class="sns-link__twitter" data-v-a49f4c2c><i aria-hidden="true" class="v-icon notranslate mdi mdi-twitter theme--light" data-v-a49f4c2c></i></a></div></div><div class="footer-copyright" data-v-a49f4c2c>
        © Serverless Operations, inc
      </div></div></div></footer></div></div>
    <script>window.__INITIAL_STATE__={"data":{"wordPressBlog":{"title":"AWSマーケットプレイスへSaaSプロダクトを掲載するために必要な作業まとめ","content":"\n\u003Cp\u003E弊社では、サーバーレスにフォーカスしたコストマネジメントSaaS、\u003Ca rel=\"noreferrer noopener\" href=\"http:\u002F\u002Fcostless.io\u002Fja\" data-type=\"URL\" data-id=\"http:\u002F\u002Fcostless.io\u002Fja\" target=\"_blank\"\u003ECostless\u003C\u002Fa\u003EをAWSマーケットプレイスに掲載しました。本記事はそのために行ってきた作業の内容について整理します。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E料金モデルの選定\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003E\u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Faws.amazon.com\u002Fmarketplace\u002Fmanagement\u002Ftour\" data-type=\"URL\" data-id=\"https:\u002F\u002Faws.amazon.com\u002Fmarketplace\u002Fmanagement\u002Ftour\" target=\"_blank\"\u003EAWSマーケットプレイスポータル\u003C\u002Fa\u003E（AMMP）で販売者登録と口座登録の手続きを済ませると、SaaSプロダクトの価格体系に合わせて以下のいずれかの料金モデルを選択し製品登録を行います。SaaS側はそれに合わせてマーケットプレイスとSaaSプロダクトとのインテグレーションを実装する形になります。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-table is-style-stripes\"\u003E\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E料金モデル\u003C\u002Ftd\u003E\u003Ctd\u003E説明\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003ESaaSサブスクリプション\u003C\u002Ftd\u003E\u003Ctd\u003Eいわゆる従量課金制モデルで、SaaSプロダクトを時間単位での利用に基づいて課金するといった場合に適しています。\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003ESaaS契約\u003C\u002Ftd\u003E\u003Ctd\u003E事前に決まった金額を支払いして一定期間SaaS製品を利用する形態の料金モデルです。\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003ESaaS契約（従量課金あり）\u003C\u002Ftd\u003E\u003Ctd\u003ESaaS 契約に加え、更に従量課金のオプションを混合することができるモデルです。最も多くのタイプの料金プランを実現できます。SaaS サブスクリプションとSaaS契約の両方をカバーできるので将来的にはおすすめの料金モデルですが、その分他に比べて実装の手間も増えることになります。\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E顧客登録及びSaaSプロダクトとの紐付け\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003E顧客がマーケットプレイスの製品ページを開いて登録（Subscribe）ボタンを押した時にリダイレクトされる、SaaS側のランディングページを用意します。顧客名、連絡先、会社名など適宜必要な顧客情報を入力してもらい、SaaS側に連携します。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003Eここで、ランディングページが開く際、マーケットプレイス側よりカスタマーID、プロダクトコードといった情報と引き換えるためのトークンを付加してリダイレクトしてくれます。SaaS側はこのトークンを受け取り、マーケットプレイスのResolveCustomerというAPIを呼び出してカスタマーIDを取得、SaaS側のユーザー情報及び各機能などが制御できるように統合します。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003E「SaaS契約」の場合、更にEntitlementという契約情報を登録、管理する必要があります。DynamoDBを利用すると良いでしょう。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E各種サブスクリプション状態の管理\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003E顧客がマーケットプレイスでサブスクリプションの登録／解除や契約変更を行った場合、予めマーケットプレイス側から用意される専用SNSトピックにその状態が通知されます。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003E具体的にはSaaS契約の場合 \u003Ccode\u003Eentitlement-updated\u003C\u002Fcode\u003E , SaaSサブスクリプションの場合４パターン（ \u003Ccode\u003Esubscribe-success\u003C\u002Fcode\u003E, \u003Ccode\u003Esubscribe-fail\u003C\u002Fcode\u003E, \u003Ccode\u003Eunsubscribe-pending\u003C\u002Fcode\u003E, \u003Ccode\u003Eunsubscribe-success\u003C\u002Fcode\u003E ）の状態が通知されます。SaaS側ではこれらの状態変更の通知を受け適宜対応する形になります。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E従量課金処理の対応\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003ESaaSサブスクリプションとSaaS契約の従量課金を実装したい場合、１時間ごとにユーザーの使用量に対する課金単位（ユニット）をマーケットプレイス側に送信する必要があります。製品登録時に構成した料金区分に合わせて課金単位の量を計算し、BatchMeterUsageという API を利用して送信します。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003EAWSマーケットプレイスチームによるE2Eテスト\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003Eここまで来たら、マーケットプレイスと統合するための作業は一通り完了します。最後に、AWSマーケットプレイスチームへ進捗を連絡すると、製品レビューとE2Eテストが実施されます。公式ドキュメントの「\u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Fdocs.aws.amazon.com\u002Fja_jp\u002Fmarketplace\u002Flatest\u002Fuserguide\u002Faws-marketplace-integration-checklist.html\" data-type=\"URL\" data-id=\"https:\u002F\u002Fdocs.aws.amazon.com\u002Fja_jp\u002Fmarketplace\u002Flatest\u002Fuserguide\u002Faws-marketplace-integration-checklist.html\" target=\"_blank\"\u003ESaaS製品チェックリスト\u003C\u002Fa\u003E」を参考に、抜け漏れがないかチェックしましょう。無事テストが通れば、公開日を設定してリリースとなります。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003Eまとめ\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003Eマーケットプレイス統合において、必要となる作業を簡単にまとめると以下のようになります。\u003C\u002Fp\u003E\n\n\n\n\u003Cul id=\"block-ca23dd63-f024-436b-a1af-735b6dcfef8a\"\u003E\u003Cli\u003E料金モデルの選定\u003C\u002Fli\u003E\u003Cli\u003E顧客登録及びSaaSプロダクトとの紐付け\u003C\u002Fli\u003E\u003Cli\u003E各種サブスクリプション状態の管理\u003C\u002Fli\u003E\u003Cli\u003E従量課金処理の対応\u003C\u002Fli\u003E\u003Cli\u003EAWSマーケットプレイスチームによるE2Eテスト\u003C\u002Fli\u003E\u003C\u002Ful\u003E\n\n\n\n\u003Cp\u003E統合を行う際に必要となるAWSリソースと構成について、AWSマーケットプレイスチームが公開している\u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Fgithub.com\u002Faws-samples\u002Faws-marketplace-serverless-saas-integration\" data-type=\"URL\" data-id=\"https:\u002F\u002Fgithub.com\u002Faws-samples\u002Faws-marketplace-serverless-saas-integration\" target=\"_blank\"\u003Eサンプル\u003C\u002Fa\u003Eがありますので、ご参考ください。フルサーバーレス構成で構築可能です。紫の丸がSaaS契約、オレンジの丸がSaaSサブスクリプションで必要となるリソースとなります。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-large\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"1024\" height=\"675\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F12\u002FServerless-MP-1024x675.png\" alt=\"\" class=\"wp-image-285\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F12\u002FServerless-MP-1024x675.png 1024w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F12\u002FServerless-MP-300x198.png 300w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F12\u002FServerless-MP-768x506.png 768w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F12\u002FServerless-MP.png 1327w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \u002F\u003E\u003Cfigcaption\u003E※ &#8220;\u003Ca class=\"\" href=\"https:\u002F\u002Fgithub.com\u002Faws-samples\u002Faws-marketplace-serverless-saas-integration\"\u003Eaws-marketplace-serverless-saas-integration\u003C\u002Fa\u003E&#8221; より抜粋\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Cp\u003EServerless Operationsでは、今回の構築経験を基にマーケットプレイスへの掲載に必要な統合の設計・開発の支援を行っています。お気軽に\u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Fserverless.co.jp\u002Fcontact\" data-type=\"URL\" data-id=\"https:\u002F\u002Fserverless.co.jp\u002Fcontact\" target=\"_blank\"\u003Eお問い合わせ\u003C\u002Fa\u003Eください。\u003C\u002Fp\u003E\n","author":{"name":"Sonu Kim","description":"","avatars":{"avatar96":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F5b527696e38c84c34048954d767b1537?s=96&d=mm&r=g"},"acf":{"userJpName":"金 仙優","userRole":"COO","facebook":"","twitter":"","github":""}},"date":"2020.12.07","path":"\u002Fblog\u002F284\u002F","featuredMedia":{"sourceUrl":"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F05\u002Fso-release.png","altText":"so-release-image","mediaDetails":{"width":1200}},"categories":[{"id":"7","title":"Blog","path":"\u002Fcategory\u002Fblog\u002F"}],"tags":[{"id":"8","title":"AWS","path":"\u002Ftag\u002Faws\u002F"},{"id":"33","title":"marketplace","path":"\u002Ftag\u002Fmarketplace\u002F"},{"id":"34","title":"SaaS","path":"\u002Ftag\u002Fsaas\u002F"},{"id":"2","title":"Serverless","path":"\u002Ftag\u002Fserverless\u002F"}]},"metadata":{"siteName":"Serverless Operations","siteDescription":"Serverless Operationsは、これまでグローバルの第一線で培ってきたクラウド技術（AWS − アマゾンウェブサービス）の豊富な実績と知見を活かし、お客さまのサーバーレスによる開発や運用の支援、コンサルティングまで一貫してサポート。サーバーレスに関するさまざまな課題を解決いたします。","siteUrl":"https:\u002F\u002Fserverless.co.jp","siteOgImage":"https:\u002F\u002Fserverless.co.jp\u002Fogp.png"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.5df06ac4.js" defer></script><script src="/assets/js/page--src--templates--word-press-blog-vue.0a0eef1f.js" defer></script><script data-vue-tag="ssr" src="https://webfont.fontplus.jp/accessor/script/fontplus.js?LuMx0zy9taw%3D&box=ME4Rs88c3-0%3D&aa=1&ab=2" data-body="true"></script>
  </body>
</html>
