<!DOCTYPE html>
<html data-html-server-rendered="true" lang="ja" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22ja%22%7D%7D">
  <head>
    <title>AWS Amplify を使って簡単に Algolia と連携した検索機能を作る | Serverless Operations</title><meta name="gridsome:hash" content="51bbfd82cb20fb429b7eb8047edc7c53796980aa"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="og:locale" property="og:locale" content="ja_JP"><meta data-vue-tag="ssr" data-key="og:site_name" property="og:site_name" content="Serverless Operations"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:image" content="https://serverless.co.jp/ogp.png"><meta data-vue-tag="ssr" data-key="og:type" property="og:type" content="article"><meta data-vue-tag="ssr" data-key="og:url" property="og:url" content="https://serverless.co.jp/blog/423/"><meta data-vue-tag="ssr" data-key="og:image" property="og:image" content="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/05/so-release.png"><meta data-vue-tag="ssr" data-key="og:title" property="og:title" content="AWS Amplify を使って簡単に Algolia と連携した検索機能を作る | Serverless Operations"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:image" content="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2020/05/so-release.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.2cc8acaa6971d9266cbf9d7d5455c37a.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css"><link data-vue-tag="ssr" data-key="canonical" rel="canonical" href="https://serverless.co.jp/blog/423/"><link rel="preload" href="/assets/css/0.styles.adfe40b8.css" as="style"><link rel="preload" href="/assets/js/app.8d74bebe.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--word-press-blog-vue.fdf3ed1a.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.84e8aa18.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.094252a3.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-archives-vue.771d12fd.js"><link rel="prefetch" href="/assets/js/page--src--pages--contact-vue.c49312ad.js"><link rel="prefetch" href="/assets/js/page--src--pages--download-vue.e2fb64ed.js"><link rel="prefetch" href="/assets/js/page--src--pages--event-archives-vue.dc6c64cc.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.6d274faf.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-archives-vue.2871bf8d.js"><link rel="prefetch" href="/assets/js/page--src--pages--our-products-vue.d569f152.js"><link rel="prefetch" href="/assets/js/page--src--pages--privacy-policy-vue.9015b9cf.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--aws-serverless-vue.548b9c96.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--aws-serverless-vue~page--src--pages--services--iot-serverless-vue.bada637e.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--index-vue.605da173.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--iot-serverless-vue.1324af58.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--serverless-consulting-vue.bf933f33.js"><link rel="prefetch" href="/assets/js/page--src--pages--services--serverless-development-vue.d8c60529.js"><link rel="prefetch" href="/assets/js/page--src--pages--test-form-vue.37425afa.js"><link rel="prefetch" href="/assets/js/page--src--pages--works-archives-vue.b641ea0a.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-category-vue.7424850d.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-post-tag-vue.a058c92f.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-post-vue.8fb7ceee.js"><link rel="prefetch" href="/assets/js/page--src--templates--word-press-works-vue.dc66c364.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--contact-vue~page--src--pages--download-vue.7a23cb3f.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--our-products-vue.8e9052c2.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--word-press-blog-vue.16b09ab1.js"><link rel="stylesheet" href="/assets/css/0.styles.adfe40b8.css"><script data-vue-tag="ssr">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MLP4448');</script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div id="app" data-server-rendered="true" class="v-application v-application--is-ltr theme--dark" data-v-7de3dd27><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MLP4448" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="v-application--wrap"><header class="header-nav" data-v-5f4f5539><div class="header-nav__logo-block" data-v-5f4f5539><a href="/" class="header-nav__logo-link active" data-v-5f4f5539><img src="/assets/img/header-logo.a93f880b.svg" alt="Severless Operations ロゴ" class="header-nav__logo" data-v-5f4f5539></a></div><nav data-v-5f4f5539><ul data-v-5f4f5539><li data-v-5f4f5539><a href="/about" data-v-5f4f5539>私たちについて</a></li><li data-v-5f4f5539><a href="/services" data-v-5f4f5539>サービス</a></li><li data-v-5f4f5539><a href="/works-archives" data-v-5f4f5539>実績紹介</a></li><li data-v-5f4f5539><a href="/blog-archives" data-v-5f4f5539>ブログ</a></li><li data-v-5f4f5539><a href="/news-archives" data-v-5f4f5539>お知らせ</a></li><li data-v-5f4f5539><a href="/download" data-v-5f4f5539>会社資料ダウンロード</a></li><li data-v-5f4f5539><a href="/contact" data-v-5f4f5539>お問い合わせ</a></li></ul></nav><div id="app" class="header-nav__toggler-block d-block d-md-none" data-v-5f4f5539><button id="btn" type="button" class="header-nav__toggler-button btn" data-v-5f4f5539><div tabindex="-1" class="btn__content" data-v-5f4f5539><span class="header-nav__toggler-top" data-v-5f4f5539></span><span class="header-nav__toggler-middle" data-v-5f4f5539></span><span class="header-nav__toggler-bottom" data-v-5f4f5539></span></div></button></div><!----></header><main class="v-content"><div class="v-content" data-v-7de3dd27><div class="v-content__wrap" data-v-7de3dd27><div class="container" data-v-7de3dd27><p class="category-title" data-v-7de3dd27>
          Blog
        </p></div><header class="post-header" data-v-7de3dd27><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><div class="col-md-10 col-11" data-v-7de3dd27><h1 class="post-title" data-v-7de3dd27>AWS Amplify を使って簡単に Algolia と連携した検索機能を作る</h1><div class="post-tag-container" data-v-7de3dd27><time datetime="2021.11.24" class="post-date" data-v-7de3dd27> 
                  2021.11.24
                  
                </time><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>Algolia</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>Amplify</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>GraphQL</span></div><div class="post-tags" data-v-7de3dd27><span data-v-7de3dd27>Serverless</span></div></div></div></div></div></header><article class="post-container" data-v-7de3dd27><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><div class="post-article-container col-md-10 col-11" data-v-7de3dd27><div class="post-article" data-v-7de3dd27>
<p>※この記事は現時点で Amplify の GraphQL Transformer v1 を対象としています。v2 対応については、連携に利用するライブラリのアップデート後に更新・追記を行う予定です。</p>



<p>最近人気を集めている高速な全文検索サービス Algolia ですが、AWS Amplify を使って簡単に連携する仕組みができていたので紹介していきます。例えば、手掛けているプロジェクトで AWS Amplify を使ったPoC/MVPアプリケーション開発をしていて、コンテンツ検索や絞り込みの機能が必要になった際、すぐに OpenSearch を取り入れるには多少負担になるといった場合におすすめできる方法です。 </p>



<h2 class="wp-block-heading">Algolia とは</h2>



<p>高速・高機能かつ使いやすいダッシュボード付きの全文検索 API サービスです。従量課金のSaaS型であることからサーバーレスとの相性がよく、各種SDKとすぐに利用可能なクライアントサイドのUI部品まで用意されており、検索機能を実装する上で優れた開発者経験が得られるサービスと言えます。</p>



<h2 class="wp-block-heading">実現したい機能と仕組み</h2>



<p>Amplify バックエンドのテンプレートでお馴染みの Blog &#8211; Post &#8211; Comment スキーマを利用して検索機能を作っていきます。Post の <code>title</code> というフィールドを Algolia に連携し、ブログ記事のタイトルを検索するイメージとして、検索窓から文字列の全文検索ができるようにします。</p>



<p>具体的には、<code>@algolia</code> ディレクティブを指定した <code>@model</code> タイプの DynamoDB Streams を有効化し、レコードが追加されたら Lambda Function 経由で Algolia に登録されます。 <code>@model</code> 名に対応するインデックスがなければ自動生成されます。</p>



<p>詳細は公式ドキュメントの <a rel="noreferrer noopener" href="https://docs.amplify.aws/cli/graphql-transformer/directives/" data-type="URL" data-id="https://docs.amplify.aws/cli/graphql-transformer/directives/" target="_blank">Directives セクション</a>にも以下のように紹介されています。</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="758" height="293" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.53.40.png" alt="" class="wp-image-428" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.53.40.png 758w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.53.40-300x116.png 300w" sizes="(max-width: 758px) 100vw, 758px" /></figure>



<h2 class="wp-block-heading">Algolia のセットアップ</h2>



<p>Algolia のダッシュボードを開きます。アカウントがない場合は algolia.com を開いて作成しておきます。</p>



<p>メニューから「API Keys」という項目を選択し、ここから Application ID と Search-Only API Key, Admin API Key を確認しておきます。後ほど、フロントエンドとバックエンドにそれぞれセットして利用することになります。</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="1015" height="545" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-11.56.43.png" alt="" class="wp-image-424" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-11.56.43.png 1015w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-11.56.43-300x161.png 300w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-11.56.43-768x412.png 768w" sizes="(max-width: 1015px) 100vw, 1015px" /></figure>



<h2 class="wp-block-heading">Amplify プロジェクトのセットアップ</h2>



<p>まずは新しく作成 or 既存のプロジェクトを開き、そこから Amplify CLI を利用して Amplify プロジェクトを展開します。</p>



<pre class="wp-block-code language-bash"><code>amplify init</code></pre>



<p>※Amplify CLI を利用していない場合、<a rel="noreferrer noopener" href="https://docs.amplify.aws/cli/start/install/" target="_blank">こちらのドキュメント</a>を参考にして入れておくと便利です。また、この記事ではサンプル作成のため create-next-app で作成した Next.js プロジェクトをベースにしています。</p>



<p>コマンドを実行するといくつか選択項目が出てきますが、利用環境に合わせて適宜指定する流れで問題ありません。作成が完了したら、引き続き GraphQL の API を追加します。本記事のサンプルで利用するスキーマのテンプレートは <code>One-to-many relationship (e.g., “Blogs” with “Posts” and “Comments”)</code> を選択しました。</p>



<pre class="wp-block-code language-bash"><code>amplify add api</code></pre>



<p>そうすると、<code>amplify/backend/api/&lt;PROJECT_NAME&gt;/schema.graphql</code> が作成され、中身を見ると以下の形になっていることが確認できます。</p>



<pre class="wp-block-code language-graphql"><code>type Blog @model {
  id: ID!
  name: String!
  posts: &#91;Post] @connection(keyName: "byBlog", fields: &#91;"id"])
}

type Post @model @key(name: "byBlog", fields: &#91;"blogID"]) {
  id: ID!
  title: String!
  blogID: ID!
  blog: Blog @connection(fields: &#91;"blogID"])
  comments: &#91;Comment] @connection(keyName: "byPost", fields: &#91;"id"])
}

type Comment @model @key(name: "byPost", fields: &#91;"postID", "content"]) {
  id: ID!
  postID: ID!
  post: Post @connection(fields: &#91;"postID"])
  content: String!
}</code></pre>



<p>ここから、<code>Post</code> の <code>title</code> に対して検索インデックスを作成するよう、<code>@algolia</code> ディレクティブを利用して以下のように指定します。</p>



<pre class="wp-block-code language-graphql"><code>type Post @model @algolia(fields:{include:&#91;"title"]}) @key(name: "byBlog", fields: &#91;"blogID"]) {
  id: ID!
  title: String!
  blogID: ID!
  blog: Blog @connection(fields: &#91;"blogID"])
  comments: &#91;Comment] @connection(keyName: "byPost", fields: &#91;"id"])
}</code></pre>



<p>続いて、Amplify プロジェクトから定義したスキーマから Algolia 検索インデックスを作成、データ連携をしてくれるライブラリをパッケージに追加します。この記事ではその先のサンプル画面作成に必要なライブラリも合わせて記載しています。</p>



<pre class="wp-block-code language-bash"><code>yarn add graphql-algolia-transformer

# サンプル画面作成で利用するモジュール
yarn add \
aws-amplify \
algoliasearch \
react-instantsearch-dom \
@types/react-instantsearch-dom</code></pre>



<p><code>transform.conf.json</code> に以下の設定を追加して先程追加したライブラリをインポートしておきます。</p>



<pre class="wp-block-code language-json"><code>// amplify/backend/api/&lt;API_NAME&gt;/transform.conf.json
// VSCodeを使っていてもしファイルが見つからない場合、.vscode/settings.json にて
// file.exclude の "amplify/**/transform.conf.json" を true にすると表示される

{
  // ... 
  "transformers": &#91;
    "graphql-algolia-transformer"
  ]
}</code></pre>



<p>Algolia インデックス作成と連携に必要な API キーをセットします。</p>



<pre class="wp-block-code language-json"><code>// /amplify/backend/api/&lt;API_NAME&gt;/parameters.json
// 現時点では冗長でも @model ごとにこの３つの項目をそれぞれ追加しなければならない

{
  "AlgoliaProjectIdPost": "SAMPLE_PROJECT", // 連携に伴うAWSリソース及び Algolia のインデックス名に付く任意のPrefix
  "AlgoliaAppIdPost": "APP_ID",
  "AlgoliaApiKeyPost": "ADMIN_API_KEY",
}</code></pre>



<p>ここまでで、Amplify バックエンド側のセットアップは一通り完了しました。以下コマンドを実行して変更を反映しておきます。</p>



<pre class="wp-block-code language-bash"><code>amplify push</code></pre>



<p>ここからは、動作を確認するために簡単はフロントエンドの画面を作っていきます。以下サンプルで作成した動作確認用のコースコードを共有しておきます。</p>



<pre class="wp-block-code language-javascript"><code>import algoliasearch from 'algoliasearch/lite'
import Amplify, { API, graphqlOperation } from 'aws-amplify';
import { InstantSearch, SearchBox, Hits } from 'react-instantsearch-dom'
import { createBlog, createPost } from '../graphql/mutations'

import awsconfig from '../aws-exports';
Amplify.configure(awsconfig);

const searchClient = algoliasearch(APP_ID, SEARCH_API_KEY)

const TestingPage = () =&gt; {

  const onClickCreateBlogBtn = () =&gt; API.graphql(graphqlOperation(createBlog, {
    input: { name: 'testing_blog_1' }
  }))

  const onClickCreatePostBtn = () =&gt; API.graphql(graphqlOperation(createPost, {
    input: { blogID: '&lt;BLOG_ID&gt;', title: 'testing_post_1' }
  }))

  return (
    &lt;&gt;
      &lt;p&gt;Spikes Amplify features&lt;/p&gt;
      &lt;button onClick={onClickCreateBlogBtn}&gt;CreateBlog&lt;/button&gt;
      &lt;button onClick={onClickCreatePostBtn}&gt;CreatePost&lt;/button&gt;
      &lt;div&gt;
        &lt;InstantSearch indexName="SAMPLE_PROJECT-post-dev" searchClient={searchClient}&gt;
          &lt;SearchBox /&gt;
          &lt;Hits /&gt;
        &lt;/InstantSearch&gt;
      &lt;/div&gt;
    &lt;/&gt;
  )
}

export default TestingPage</code></pre>



<h2 class="wp-block-heading">画面の確認</h2>



<p>まず Blog のレコードを作成し、次に <code>testing_blog_1</code> という title で Post のレコードを作成します。DynamoDB の Post テーブルにはこういう形でレコードが登録されます。</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="937" height="91" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.42.14.png" alt="" class="wp-image-426" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.42.14.png 937w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.42.14-300x29.png 300w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.42.14-768x75.png 768w" sizes="(max-width: 937px) 100vw, 937px" /></figure>



<p>その後すぐに Algolia に連携され、ダッシュボードから検索可能な形でインデックスが登録されていることが確認できます。</p>



<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="1024" height="523" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.37.05-1024x523.png" alt="" class="wp-image-425" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.37.05-1024x523.png 1024w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.37.05-300x153.png 300w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.37.05-768x392.png 768w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.37.05.png 1062w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>最後に、サンプルで作成した画面で実際に検索が動作することを確認します。<code>title</code> フィールドに指定した文字列の最初の数文字を打った時点ですでに検索結果が表示されるようになります。</p>



<figure class="wp-block-image size-full"><img decoding="async" loading="lazy" width="817" height="137" src="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.36.12.png" alt="" class="wp-image-427" srcset="https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.36.12.png 817w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.36.12-300x50.png 300w, https://cdn.getshifter.co/f6642def64a63651c07142605e040674c5441f6d/uploads/2021/11/Screen-Shot-2021-11-23-at-21.36.12-768x129.png 768w" sizes="(max-width: 817px) 100vw, 817px" /></figure>



<h2 class="wp-block-heading">おわりに</h2>



<p>いくつか細かい設定を必要とするため多少手間に感じることもあるかと思いますが、実際にやってみると多くの時間をかけることなく検索機能を実現できる方法となります。標準の OpenSearch を利用することも有効な選択肢ではありますが、Algolia を利用することで監視項目や管理対象のAWSリソースを減らし、従量課金のメリットを享受できるため、一度検討してみてはいかがでしょうか。</p>
</div><section class="l-share-button" data-v-629ec8b5 data-v-7de3dd27><aside class="p-share-button" data-v-629ec8b5><div class="p-share-button__header" data-v-629ec8b5>SHARE</div><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fserverless.co.jp%2Fblog%2F423%2F" target="_blank" title="Facebookでシェア" class="p-share-button__link--facebook " data-v-629ec8b5><i class="mdi mdi-facebook" data-v-629ec8b5></i></a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fserverless.co.jp%2Fblog%2F423%2F&amp;text=AWS%20Amplify%20%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%B0%A1%E5%8D%98%E3%81%AB%20Algolia%20%E3%81%A8%E9%80%A3%E6%90%BA%E3%81%97%E3%81%9F%E6%A4%9C%E7%B4%A2%E6%A9%9F%E8%83%BD%E3%82%92%E4%BD%9C%E3%82%8B" target="_blank" title="Twitterでシェア" class="p-share-button__link--twitter" data-v-629ec8b5><i class="mdi mdi-twitter" data-v-629ec8b5></i></a></aside></section><div class="post-author-container" data-v-7de3dd27><h5 class="post-author-title" data-v-7de3dd27>Written by</h5><div class="post-author-text" data-v-7de3dd27><p data-v-7de3dd27><span class="role" data-v-7de3dd27>
                      COO
                    </span><span class="name-jp" data-v-7de3dd27>
                      金 仙優
                    </span><span class="name-en" data-v-7de3dd27>
                      Sonu Kim
                    </span></p><p class="author-desc" data-v-7de3dd27>
                    
                  </p><ul class="author-sns" data-v-7de3dd27><li data-v-7de3dd27><!----></li><li data-v-7de3dd27><!----></li><li data-v-7de3dd27><!----></li></ul></div></div></div></div></div><div class="p-news-bg" data-v-7de3dd27></div></article><div class="container" data-v-7de3dd27><div class="row justify-center" data-v-7de3dd27><a href="/blog-archives" class="post-archives-link" data-v-7de3dd27><span class="post-archives-link-text" data-v-7de3dd27>BACK TO LIST</span><span data-v-7de3dd27><img src="/assets/img/icon-back-to-list.3add3700.svg" alt="BACK TO LIST アイコン" data-v-7de3dd27></span></a></div></div></div></div></main><footer class="v-footer footer v-sheet v-sheet--tile theme--dark" data-v-a49f4c2c><div class="container" data-v-a49f4c2c data-v-a49f4c2c><div class="row" data-v-a49f4c2c data-v-a49f4c2c><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/works-archives" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Works</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>実績紹介</div></a><ul class="c-footer-list" data-v-a49f4c2c><div data-v-b68eaa08 data-v-a49f4c2c><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/666/" class="c-footer-list__link" data-v-b68eaa08>
      A社（企業名非公開）
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/501/" class="c-footer-list__link" data-v-b68eaa08>
      戸田建設株式会社
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/396/" class="c-footer-list__link" data-v-b68eaa08>
      北海道テレビ放送株式会社
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/358/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社Geolonia
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/24/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社LIXIL
    </a></li><li class="c-footer-list__item" data-v-b68eaa08><a href="/works/185/" class="c-footer-list__link" data-v-b68eaa08>
      株式会社TOKION
    </a></li></div></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><div data-v-a49f4c2c><a href="/services" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Services</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>サービス紹介</div></a></div><ul class="c-footer-list" data-v-a49f4c2c><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスオペレーションズの<br data-v-a49f4c2c>サービスと強み</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/iot-serverless" class="c-footer-list__link" data-v-a49f4c2c>
              IoT × サーバーレス / コンテナ開発<br data-v-a49f4c2c>導⼊サポート
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/aws-serverless" class="c-footer-list__link" data-v-a49f4c2c>
              AWSコアサーバーレスサービスの開発導⼊サポート
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/serverless-consulting" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスコンサルティング</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/services/serverless-development" class="c-footer-list__link" data-v-a49f4c2c>サーバーレスディべロプメント</a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/our-products" class="c-footer-list__link" data-v-a49f4c2c>
              自社開発プロダクト
            </a></li></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/blog-archives" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>Blog</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>開発ブログ</div></a><ul class="c-footer-list" data-v-a49f4c2c><div data-v-39434060 data-v-a49f4c2c><li class="c-footer-list__item" data-v-39434060><a href="/blog/640/" class="c-footer-list__link" data-v-39434060>
      AWS 開発基盤として、セキュリティを考慮したマルチアカウント構成のススメ
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/532/" class="c-footer-list__link" data-v-39434060>
      AWS Amplify GraphQL Transformer v2 のデータモデリングとリレーションの仕組みを解説する
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/512/" class="c-footer-list__link" data-v-39434060>
      AWS Lambda + Nuxt3で実現する「サーバーレスなSSR」とその構成
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/25/" class="c-footer-list__link" data-v-39434060>
      Serverless Frameworkの使い方まとめ
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/450/" class="c-footer-list__link" data-v-39434060>
      軽量で簡単に使えるキャッシュSaaS、MomentoをAWS Lambdaから使ってみる
    </a></li><li class="c-footer-list__item" data-v-39434060><a href="/blog/429/" class="c-footer-list__link" data-v-39434060>
      Next.js アプリケーションを AWS Amplify でホスティングする上でのTIPS
    </a></li></div></ul></div><div class="footer-list-anim col-sm-6 col-md-3 col-12" data-v-a49f4c2c data-v-a49f4c2c><a href="/about" class="c-footer-list__link" data-v-a49f4c2c><div class="c-footer-menu__title" data-v-a49f4c2c>About</div><div class="c-footer-menu__subtitle" data-v-a49f4c2c>会社案内</div></a><ul class="c-footer-list" data-v-a49f4c2c><li class="c-footer-list__item" data-v-a49f4c2c><a href="/about" class="c-footer-list__link" data-v-a49f4c2c>
              会社案内
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/news-archives/" class="c-footer-list__link" data-v-a49f4c2c>
              おしらせ
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/privacy-policy/" class="c-footer-list__link" data-v-a49f4c2c>
              プライバシーポリシー
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/download" class="c-footer-list__link" data-v-a49f4c2c>
              会社資料ダウンロード
            </a></li><li class="c-footer-list__item" data-v-a49f4c2c><a href="/contact" class="c-footer-list__link" data-v-a49f4c2c>
              お問い合わせ
            </a></li></ul></div></div><div class="row mt-8 mt-md-12" data-v-a49f4c2c data-v-a49f4c2c><div class="col-md-2 col-12" data-v-a49f4c2c data-v-a49f4c2c><div data-v-a49f4c2c><a href="/" class="active" data-v-a49f4c2c><img src="/assets/img/footer-severless-operations-logo.e1e6687a.svg" alt="Severless Operations ロゴ" data-v-a49f4c2c></a></div></div><div class="col-md-10 col-12" data-v-a49f4c2c data-v-a49f4c2c><div class="sns-link text-md-right" data-v-a49f4c2c><a href="https://github.com/serverless-operations" target="_blank" class="sns-link__github" data-v-a49f4c2c><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--light" data-v-a49f4c2c></i></a><a href="https://twitter.com/slsopsinc" target="_blank" class="sns-link__twitter" data-v-a49f4c2c><i aria-hidden="true" class="v-icon notranslate mdi mdi-twitter theme--light" data-v-a49f4c2c></i></a></div></div><div class="footer-copyright" data-v-a49f4c2c>
        © Serverless Operations, inc
      </div></div></div></footer></div></div>
    <script>window.__INITIAL_STATE__={"data":{"wordPressBlog":{"title":"AWS Amplify を使って簡単に Algolia と連携した検索機能を作る","content":"\n\u003Cp\u003E※この記事は現時点で Amplify の GraphQL Transformer v1 を対象としています。v2 対応については、連携に利用するライブラリのアップデート後に更新・追記を行う予定です。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003E最近人気を集めている高速な全文検索サービス Algolia ですが、AWS Amplify を使って簡単に連携する仕組みができていたので紹介していきます。例えば、手掛けているプロジェクトで AWS Amplify を使ったPoC\u002FMVPアプリケーション開発をしていて、コンテンツ検索や絞り込みの機能が必要になった際、すぐに OpenSearch を取り入れるには多少負担になるといった場合におすすめできる方法です。 \u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003EAlgolia とは\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003E高速・高機能かつ使いやすいダッシュボード付きの全文検索 API サービスです。従量課金のSaaS型であることからサーバーレスとの相性がよく、各種SDKとすぐに利用可能なクライアントサイドのUI部品まで用意されており、検索機能を実装する上で優れた開発者経験が得られるサービスと言えます。\u003C\u002Fp\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E実現したい機能と仕組み\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EAmplify バックエンドのテンプレートでお馴染みの Blog &#8211; Post &#8211; Comment スキーマを利用して検索機能を作っていきます。Post の \u003Ccode\u003Etitle\u003C\u002Fcode\u003E というフィールドを Algolia に連携し、ブログ記事のタイトルを検索するイメージとして、検索窓から文字列の全文検索ができるようにします。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003E具体的には、\u003Ccode\u003E@algolia\u003C\u002Fcode\u003E ディレクティブを指定した \u003Ccode\u003E@model\u003C\u002Fcode\u003E タイプの DynamoDB Streams を有効化し、レコードが追加されたら Lambda Function 経由で Algolia に登録されます。 \u003Ccode\u003E@model\u003C\u002Fcode\u003E 名に対応するインデックスがなければ自動生成されます。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003E詳細は公式ドキュメントの \u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Fdocs.amplify.aws\u002Fcli\u002Fgraphql-transformer\u002Fdirectives\u002F\" data-type=\"URL\" data-id=\"https:\u002F\u002Fdocs.amplify.aws\u002Fcli\u002Fgraphql-transformer\u002Fdirectives\u002F\" target=\"_blank\"\u003EDirectives セクション\u003C\u002Fa\u003Eにも以下のように紹介されています。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-full\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"758\" height=\"293\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.53.40.png\" alt=\"\" class=\"wp-image-428\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.53.40.png 758w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.53.40-300x116.png 300w\" sizes=\"(max-width: 758px) 100vw, 758px\" \u002F\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003EAlgolia のセットアップ\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003EAlgolia のダッシュボードを開きます。アカウントがない場合は algolia.com を開いて作成しておきます。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003Eメニューから「API Keys」という項目を選択し、ここから Application ID と Search-Only API Key, Admin API Key を確認しておきます。後ほど、フロントエンドとバックエンドにそれぞれセットして利用することになります。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-full\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"1015\" height=\"545\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-11.56.43.png\" alt=\"\" class=\"wp-image-424\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-11.56.43.png 1015w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-11.56.43-300x161.png 300w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-11.56.43-768x412.png 768w\" sizes=\"(max-width: 1015px) 100vw, 1015px\" \u002F\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003EAmplify プロジェクトのセットアップ\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003Eまずは新しく作成 or 既存のプロジェクトを開き、そこから Amplify CLI を利用して Amplify プロジェクトを展開します。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-bash\"\u003E\u003Ccode\u003Eamplify init\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003E※Amplify CLI を利用していない場合、\u003Ca rel=\"noreferrer noopener\" href=\"https:\u002F\u002Fdocs.amplify.aws\u002Fcli\u002Fstart\u002Finstall\u002F\" target=\"_blank\"\u003Eこちらのドキュメント\u003C\u002Fa\u003Eを参考にして入れておくと便利です。また、この記事ではサンプル作成のため create-next-app で作成した Next.js プロジェクトをベースにしています。\u003C\u002Fp\u003E\n\n\n\n\u003Cp\u003Eコマンドを実行するといくつか選択項目が出てきますが、利用環境に合わせて適宜指定する流れで問題ありません。作成が完了したら、引き続き GraphQL の API を追加します。本記事のサンプルで利用するスキーマのテンプレートは \u003Ccode\u003EOne-to-many relationship (e.g., “Blogs” with “Posts” and “Comments”)\u003C\u002Fcode\u003E を選択しました。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-bash\"\u003E\u003Ccode\u003Eamplify add api\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003Eそうすると、\u003Ccode\u003Eamplify\u002Fbackend\u002Fapi\u002F&lt;PROJECT_NAME&gt;\u002Fschema.graphql\u003C\u002Fcode\u003E が作成され、中身を見ると以下の形になっていることが確認できます。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-graphql\"\u003E\u003Ccode\u003Etype Blog @model {\n  id: ID!\n  name: String!\n  posts: &#91;Post] @connection(keyName: \"byBlog\", fields: &#91;\"id\"])\n}\n\ntype Post @model @key(name: \"byBlog\", fields: &#91;\"blogID\"]) {\n  id: ID!\n  title: String!\n  blogID: ID!\n  blog: Blog @connection(fields: &#91;\"blogID\"])\n  comments: &#91;Comment] @connection(keyName: \"byPost\", fields: &#91;\"id\"])\n}\n\ntype Comment @model @key(name: \"byPost\", fields: &#91;\"postID\", \"content\"]) {\n  id: ID!\n  postID: ID!\n  post: Post @connection(fields: &#91;\"postID\"])\n  content: String!\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003Eここから、\u003Ccode\u003EPost\u003C\u002Fcode\u003E の \u003Ccode\u003Etitle\u003C\u002Fcode\u003E に対して検索インデックスを作成するよう、\u003Ccode\u003E@algolia\u003C\u002Fcode\u003E ディレクティブを利用して以下のように指定します。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-graphql\"\u003E\u003Ccode\u003Etype Post @model @algolia(fields:{include:&#91;\"title\"]}) @key(name: \"byBlog\", fields: &#91;\"blogID\"]) {\n  id: ID!\n  title: String!\n  blogID: ID!\n  blog: Blog @connection(fields: &#91;\"blogID\"])\n  comments: &#91;Comment] @connection(keyName: \"byPost\", fields: &#91;\"id\"])\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003E続いて、Amplify プロジェクトから定義したスキーマから Algolia 検索インデックスを作成、データ連携をしてくれるライブラリをパッケージに追加します。この記事ではその先のサンプル画面作成に必要なライブラリも合わせて記載しています。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-bash\"\u003E\u003Ccode\u003Eyarn add graphql-algolia-transformer\n\n# サンプル画面作成で利用するモジュール\nyarn add \\\naws-amplify \\\nalgoliasearch \\\nreact-instantsearch-dom \\\n@types\u002Freact-instantsearch-dom\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003E\u003Ccode\u003Etransform.conf.json\u003C\u002Fcode\u003E に以下の設定を追加して先程追加したライブラリをインポートしておきます。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-json\"\u003E\u003Ccode\u003E\u002F\u002F amplify\u002Fbackend\u002Fapi\u002F&lt;API_NAME&gt;\u002Ftransform.conf.json\n\u002F\u002F VSCodeを使っていてもしファイルが見つからない場合、.vscode\u002Fsettings.json にて\n\u002F\u002F file.exclude の \"amplify\u002F**\u002Ftransform.conf.json\" を true にすると表示される\n\n{\n  \u002F\u002F ... \n  \"transformers\": &#91;\n    \"graphql-algolia-transformer\"\n  ]\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003EAlgolia インデックス作成と連携に必要な API キーをセットします。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-json\"\u003E\u003Ccode\u003E\u002F\u002F \u002Famplify\u002Fbackend\u002Fapi\u002F&lt;API_NAME&gt;\u002Fparameters.json\n\u002F\u002F 現時点では冗長でも @model ごとにこの３つの項目をそれぞれ追加しなければならない\n\n{\n  \"AlgoliaProjectIdPost\": \"SAMPLE_PROJECT\", \u002F\u002F 連携に伴うAWSリソース及び Algolia のインデックス名に付く任意のPrefix\n  \"AlgoliaAppIdPost\": \"APP_ID\",\n  \"AlgoliaApiKeyPost\": \"ADMIN_API_KEY\",\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003Eここまでで、Amplify バックエンド側のセットアップは一通り完了しました。以下コマンドを実行して変更を反映しておきます。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-bash\"\u003E\u003Ccode\u003Eamplify push\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Cp\u003Eここからは、動作を確認するために簡単はフロントエンドの画面を作っていきます。以下サンプルで作成した動作確認用のコースコードを共有しておきます。\u003C\u002Fp\u003E\n\n\n\n\u003Cpre class=\"wp-block-code language-javascript\"\u003E\u003Ccode\u003Eimport algoliasearch from 'algoliasearch\u002Flite'\nimport Amplify, { API, graphqlOperation } from 'aws-amplify';\nimport { InstantSearch, SearchBox, Hits } from 'react-instantsearch-dom'\nimport { createBlog, createPost } from '..\u002Fgraphql\u002Fmutations'\n\nimport awsconfig from '..\u002Faws-exports';\nAmplify.configure(awsconfig);\n\nconst searchClient = algoliasearch(APP_ID, SEARCH_API_KEY)\n\nconst TestingPage = () =&gt; {\n\n  const onClickCreateBlogBtn = () =&gt; API.graphql(graphqlOperation(createBlog, {\n    input: { name: 'testing_blog_1' }\n  }))\n\n  const onClickCreatePostBtn = () =&gt; API.graphql(graphqlOperation(createPost, {\n    input: { blogID: '&lt;BLOG_ID&gt;', title: 'testing_post_1' }\n  }))\n\n  return (\n    &lt;&gt;\n      &lt;p&gt;Spikes Amplify features&lt;\u002Fp&gt;\n      &lt;button onClick={onClickCreateBlogBtn}&gt;CreateBlog&lt;\u002Fbutton&gt;\n      &lt;button onClick={onClickCreatePostBtn}&gt;CreatePost&lt;\u002Fbutton&gt;\n      &lt;div&gt;\n        &lt;InstantSearch indexName=\"SAMPLE_PROJECT-post-dev\" searchClient={searchClient}&gt;\n          &lt;SearchBox \u002F&gt;\n          &lt;Hits \u002F&gt;\n        &lt;\u002FInstantSearch&gt;\n      &lt;\u002Fdiv&gt;\n    &lt;\u002F&gt;\n  )\n}\n\nexport default TestingPage\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003E画面の確認\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003Eまず Blog のレコードを作成し、次に \u003Ccode\u003Etesting_blog_1\u003C\u002Fcode\u003E という title で Post のレコードを作成します。DynamoDB の Post テーブルにはこういう形でレコードが登録されます。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-full\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"937\" height=\"91\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.42.14.png\" alt=\"\" class=\"wp-image-426\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.42.14.png 937w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.42.14-300x29.png 300w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.42.14-768x75.png 768w\" sizes=\"(max-width: 937px) 100vw, 937px\" \u002F\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Cp\u003Eその後すぐに Algolia に連携され、ダッシュボードから検索可能な形でインデックスが登録されていることが確認できます。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-large\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"1024\" height=\"523\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.37.05-1024x523.png\" alt=\"\" class=\"wp-image-425\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.37.05-1024x523.png 1024w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.37.05-300x153.png 300w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.37.05-768x392.png 768w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.37.05.png 1062w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \u002F\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Cp\u003E最後に、サンプルで作成した画面で実際に検索が動作することを確認します。\u003Ccode\u003Etitle\u003C\u002Fcode\u003E フィールドに指定した文字列の最初の数文字を打った時点ですでに検索結果が表示されるようになります。\u003C\u002Fp\u003E\n\n\n\n\u003Cfigure class=\"wp-block-image size-full\"\u003E\u003Cimg decoding=\"async\" loading=\"lazy\" width=\"817\" height=\"137\" src=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.36.12.png\" alt=\"\" class=\"wp-image-427\" srcset=\"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.36.12.png 817w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.36.12-300x50.png 300w, https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2021\u002F11\u002FScreen-Shot-2021-11-23-at-21.36.12-768x129.png 768w\" sizes=\"(max-width: 817px) 100vw, 817px\" \u002F\u003E\u003C\u002Ffigure\u003E\n\n\n\n\u003Ch2 class=\"wp-block-heading\"\u003Eおわりに\u003C\u002Fh2\u003E\n\n\n\n\u003Cp\u003Eいくつか細かい設定を必要とするため多少手間に感じることもあるかと思いますが、実際にやってみると多くの時間をかけることなく検索機能を実現できる方法となります。標準の OpenSearch を利用することも有効な選択肢ではありますが、Algolia を利用することで監視項目や管理対象のAWSリソースを減らし、従量課金のメリットを享受できるため、一度検討してみてはいかがでしょうか。\u003C\u002Fp\u003E\n","author":{"name":"Sonu Kim","description":"","avatars":{"avatar96":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F5b527696e38c84c34048954d767b1537?s=96&d=mm&r=g"},"acf":{"userJpName":"金 仙優","userRole":"COO","facebook":"","twitter":"","github":""}},"date":"2021.11.24","path":"\u002Fblog\u002F423\u002F","featuredMedia":{"sourceUrl":"https:\u002F\u002Fcdn.getshifter.co\u002Ff6642def64a63651c07142605e040674c5441f6d\u002Fuploads\u002F2020\u002F05\u002Fso-release.png","altText":"so-release-image","mediaDetails":{"width":1200}},"categories":[{"id":"7","title":"Blog","path":"\u002Fcategory\u002Fblog\u002F"}],"tags":[{"id":"52","title":"Algolia","path":"\u002Ftag\u002Falgolia\u002F"},{"id":"53","title":"Amplify","path":"\u002Ftag\u002Famplify\u002F"},{"id":"54","title":"GraphQL","path":"\u002Ftag\u002Fgraphql\u002F"},{"id":"2","title":"Serverless","path":"\u002Ftag\u002Fserverless\u002F"}]},"metadata":{"siteName":"Serverless Operations","siteDescription":"Serverless Operationsは、これまでグローバルの第一線で培ってきたクラウド技術（AWS − アマゾンウェブサービス）の豊富な実績と知見を活かし、お客さまのサーバーレスによる開発や運用の支援、コンサルティングまで一貫してサポート。サーバーレスに関するさまざまな課題を解決いたします。","siteUrl":"https:\u002F\u002Fserverless.co.jp","siteOgImage":"https:\u002F\u002Fserverless.co.jp\u002Fogp.png"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.8d74bebe.js" defer></script><script src="/assets/js/page--src--templates--word-press-blog-vue.fdf3ed1a.js" defer></script><script data-vue-tag="ssr" src="https://webfont.fontplus.jp/accessor/script/fontplus.js?LuMx0zy9taw%3D&box=ME4Rs88c3-0%3D&aa=1&ab=2" data-body="true"></script>
  </body>
</html>
